import{r as n,j as t}from"./app-BPOq-aCu.js";import{u as I,D as $,f as S,c as k,g as D,a as F,b as T,d as H}from"./index-BppqkAjo.js";import{I as L}from"./index-BEfbAIe0.js";import{M as W,u as E,P as G,a as O,L as V,E as B}from"./ExpandableRow-DR6ijSiP.js";import"./iconBase-eZT6xShD.js";import"./HorizontalBarChart-DGEEcEti.js";import"./useQuery-C1-uSyxu.js";import"./utils-BbyRsr_B.js";class K extends n.Component{getSnapshotBeforeUpdate(c){const r=this.props.childRef.current;if(r&&c.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=r.offsetHeight||0,l.width=r.offsetWidth||0,l.top=r.offsetTop,l.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function U({children:d,isPresent:c}){const r=n.useId(),l=n.useRef(null),m=n.useRef({width:0,height:0,top:0,left:0}),{nonce:g}=n.useContext(W);return n.useInsertionEffect(()=>{const{width:x,height:o,top:p,left:i}=m.current;if(c||!l.current||!x||!o)return;l.current.dataset.motionPopId=r;const a=document.createElement("style");return g&&(a.nonce=g),document.head.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${o}px !important;
            top: ${p}px !important;
            left: ${i}px !important;
          }
        `),()=>{document.head.removeChild(a)}},[c]),t.jsx(K,{isPresent:c,childRef:l,sizeRef:m,children:n.cloneElement(d,{ref:l})})}const _=({children:d,initial:c,isPresent:r,onExitComplete:l,custom:m,presenceAffectsLayout:g,mode:x})=>{const o=E(A),p=n.useId(),i=n.useMemo(()=>({id:p,initial:c,isPresent:r,custom:m,onExitComplete:a=>{o.set(a,!0);for(const e of o.values())if(!e)return;l&&l()},register:a=>(o.set(a,!1),()=>o.delete(a))}),g?[Math.random()]:[r]);return n.useMemo(()=>{o.forEach((a,e)=>o.set(e,!1))},[r]),n.useEffect(()=>{!r&&!o.size&&l&&l()},[r]),x==="popLayout"&&(d=t.jsx(U,{isPresent:r,children:d})),t.jsx(G.Provider,{value:i,children:d})};function A(){return new Map}const j=d=>d.key||"";function M(d){const c=[];return n.Children.forEach(d,r=>{n.isValidElement(r)&&c.push(r)}),c}const q=({children:d,exitBeforeEnter:c,custom:r,initial:l=!0,onExitComplete:m,presenceAffectsLayout:g=!0,mode:x="sync"})=>{const o=n.useMemo(()=>M(d),[d]),p=o.map(j),i=n.useRef(!0),a=n.useRef(o),e=E(()=>new Map),[s,P]=n.useState(o),[f,R]=n.useState(o);O(()=>{i.current=!1,a.current=o;for(let h=0;h<f.length;h++){const u=j(f[h]);p.includes(u)?e.delete(u):e.get(u)!==!0&&e.set(u,!1)}},[f,p.length,p.join("-")]);const v=[];if(o!==s){let h=[...o];for(let u=0;u<f.length;u++){const C=f[u],w=j(C);p.includes(w)||(h.splice(u,0,C),v.push(C))}x==="wait"&&v.length&&(h=v),R(M(h)),P(o);return}const{forceRender:y}=n.useContext(V);return t.jsx(t.Fragment,{children:f.map(h=>{const u=j(h),C=o===f||p.includes(u),w=()=>{if(e.has(u))e.set(u,!0);else return;let N=!0;e.forEach(z=>{z||(N=!1)}),N&&(y==null||y(),R(a.current),m&&m())};return t.jsx(_,{isPresent:C,initial:!i.current||l?void 0:!1,custom:C?void 0:r,presenceAffectsLayout:g,mode:x,onExitComplete:C?void 0:w,children:h},u)})})},b=k(),J=({flows:d})=>{var a;const[c,r]=n.useState({}),[l,m]=n.useState([]),[g,x]=n.useState(""),o=e=>{r(s=>({...s,[e]:!s[e]}))},p=n.useMemo(()=>[b.accessor("id",{header:"ID",size:20}),b.accessor("category",{header:"診断タイプ",size:25,cell:({getValue:e})=>{const s=e();switch(s){case"standard":return"標準";case"cityHeaven":return"シティヘブン";default:return s}}}),b.accessor("title",{header:"診断タイトル"}),b.accessor("total",{header:"合計",size:25,cell:e=>t.jsx("div",{className:"text-start",children:e.getValue()})}),b.display({id:"viewGraph",header:"内訳",size:25,cell:({row:e})=>t.jsx("button",{onClick:()=>{o(e.index)},className:`select-none transtion-all duration-200
              ${c[e.index]?"text-red-400 hover:text-red-700":"text-indigo-400 hover:text-indigo-700"}`,children:c[e.index]?"閉じる":"表示"})})],[c]),i=I({data:d,columns:p,getCoreRowModel:D(),onSortingChange:m,getSortedRowModel:F(),getFilteredRowModel:T(),getPaginationRowModel:H(),state:{sorting:l,globalFilter:g},defaultColumn:{size:200}});return t.jsx(t.Fragment,{children:t.jsx("div",{className:"max-w-full w-11/12 mx-auto sm:px-6 lg:py-8",children:t.jsx("div",{className:"bg-white overflow-hidden shadow-sm",children:t.jsxs("div",{className:"pb-3 px-6",children:[t.jsxs("div",{className:"flex justify-start items-center h-24",children:[t.jsx("div",{className:"h-12 bg-slate-600 px-2 rounded-l",children:t.jsx(L,{className:"h-full block text-white"})}),t.jsx("div",{className:"h-full flex justify-center items-center",children:t.jsx($,{value:g??"",handleChange:e=>x(String(e)),className:"w-96 h-12 bg-transparent outline-none border rounded-r border-slate-300 focus:ring-0 focus:border-blue-500 placeholder:text-slate-400",placeholder:"検索"})})]}),t.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-700",children:[t.jsx("thead",{className:"text-sm text-gray-700 uppercase bg-gray-200 ",children:i.getHeaderGroups().map(e=>t.jsx("tr",{children:e.headers.map(s=>t.jsx("th",{colSpan:s.colSpan,style:{maxWidth:s.getSize()},children:s.isPlaceholder?null:t.jsxs("div",{className:`px-3 py-3 ${s.column.getCanSort()?"cursor-pointer select-none":""}`,onClick:s.column.getToggleSortingHandler(),title:s.column.getCanSort()?s.column.getNextSortingOrder()==="asc"?"昇順ソート":s.column.getNextSortingOrder()==="desc"?"降順ソート":"元の並びに戻す":void 0,children:[S(s.column.columnDef.header,s.getContext()),{asc:"↑",desc:"↓"}[s.column.getIsSorted()]??null]})},s.id))},e.id))}),t.jsx("tbody",{children:(a=i.getRowModel().rows)!=null&&a.length?i.getRowModel().rows.map(e=>t.jsxs(n.Fragment,{children:[t.jsx("tr",{"data-state":e.getIsSelected()&&"selected",className:"bg-white border-b ",children:e.getVisibleCells().map(s=>t.jsx("td",{className:"px-2 py-2",style:{maxWidth:`${s.column.getSize()}px`,overflow:"hidden",overflowWrap:"break-word"},children:S(s.column.columnDef.cell,s.getContext())},s.id))},e.id),t.jsx(q,{children:c[e.index]&&t.jsx(B,{flowId:e.original.id,colLength:p.length},`graph_${e.id}`)})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:p.length,className:"h-24 text-center",children:"対象レコード0件"})})})]}),t.jsxs("div",{className:"flex items-center justify-center mt-4 gap-8",children:[t.jsxs("div",{className:"w-12 flex justify-center gap-2",children:[t.jsx("button",{onClick:()=>i.previousPage(),disabled:!i.getCanPreviousPage(),className:"p-1 border border-gray-300 px-2 disabled:opacity-30 select-none cursor-pointer",children:"<"}),t.jsx("button",{onClick:()=>i.nextPage(),disabled:!i.getCanNextPage(),className:"p-1 border border-gray-300 px-2 disabled:opacity-30 select-none cursor-pointer",children:">"})]}),t.jsx("div",{className:"flex items-center",children:t.jsx("div",{className:"text-gray-500",children:`${i.getState().pagination.pageIndex+1} / ${i.getPageCount()}`})}),t.jsx("select",{value:i.getState().pagination.pageSize,onChange:e=>i.setPageSize(Number(e.currentTarget.value)),className:"py-2 pr-8 bg-transparent cursor-pointer select-none border-1 border-slate-200 focus:ring-0 focus:border-blue-500 text-sm",children:[10,20,30,50].map(e=>t.jsx("option",{value:e,children:`${e} 行表示`},e))})]})]})})})})},re=n.memo(J);export{re as default};
