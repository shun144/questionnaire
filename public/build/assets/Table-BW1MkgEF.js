import{r as n,j as t}from"./app-MNzaSWed.js";import{u as I,D as $,f as S,c as k,g as D,a as F,b as T,d as L}from"./index-De-x3U3l.js";import{I as H}from"./index-DmRn-Okf.js";import O from"./ExpandableRow-DdIRMUAi.js";import{M as W,u as P,P as G,a as V,L as B}from"./proxy-w-H6oLat.js";import"./iconBase-C8iXxnql.js";import"./HorizontalBarChart-D19X1vRE.js";import"./utils-DDUM_FvQ.js";class K extends n.Component{getSnapshotBeforeUpdate(a){const r=this.props.childRef.current;if(r&&a.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function U({children:c,isPresent:a}){const r=n.useId(),i=n.useRef(null),m=n.useRef({width:0,height:0,top:0,left:0}),{nonce:x}=n.useContext(W);return n.useInsertionEffect(()=>{const{width:g,height:o,top:u,left:l}=m.current;if(a||!i.current||!g||!o)return;i.current.dataset.motionPopId=r;const p=document.createElement("style");return x&&(p.nonce=x),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${o}px !important;
            top: ${u}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[a]),t.jsx(K,{isPresent:a,childRef:i,sizeRef:m,children:n.cloneElement(c,{ref:i})})}const _=({children:c,initial:a,isPresent:r,onExitComplete:i,custom:m,presenceAffectsLayout:x,mode:g})=>{const o=P(A),u=n.useId(),l=n.useCallback(e=>{o.set(e,!0);for(const s of o.values())if(!s)return;i&&i()},[o,i]),p=n.useMemo(()=>({id:u,initial:a,isPresent:r,custom:m,onExitComplete:l,register:e=>(o.set(e,!1),()=>o.delete(e))}),x?[Math.random(),l]:[r,l]);return n.useMemo(()=>{o.forEach((e,s)=>o.set(s,!1))},[r]),n.useEffect(()=>{!r&&!o.size&&i&&i()},[r]),g==="popLayout"&&(c=t.jsx(U,{isPresent:r,children:c})),t.jsx(G.Provider,{value:p,children:c})};function A(){return new Map}const b=c=>c.key||"";function M(c){const a=[];return n.Children.forEach(c,r=>{n.isValidElement(r)&&a.push(r)}),a}const q=({children:c,exitBeforeEnter:a,custom:r,initial:i=!0,onExitComplete:m,presenceAffectsLayout:x=!0,mode:g="sync"})=>{const o=n.useMemo(()=>M(c),[c]),u=o.map(b),l=n.useRef(!0),p=n.useRef(o),e=P(()=>new Map),[s,E]=n.useState(o),[f,R]=n.useState(o);V(()=>{l.current=!1,p.current=o;for(let h=0;h<f.length;h++){const d=b(f[h]);u.includes(d)?e.delete(d):e.get(d)!==!0&&e.set(d,!1)}},[f,u.length,u.join("-")]);const v=[];if(o!==s){let h=[...o];for(let d=0;d<f.length;d++){const C=f[d],w=b(C);u.includes(w)||(h.splice(d,0,C),v.push(C))}g==="wait"&&v.length&&(h=v),R(M(h)),E(o);return}const{forceRender:y}=n.useContext(B);return t.jsx(t.Fragment,{children:f.map(h=>{const d=b(h),C=o===f||u.includes(d),w=()=>{if(e.has(d))e.set(d,!0);else return;let N=!0;e.forEach(z=>{z||(N=!1)}),N&&(y==null||y(),R(p.current),m&&m())};return t.jsx(_,{isPresent:C,initial:!l.current||i?void 0:!1,custom:C?void 0:r,presenceAffectsLayout:x,mode:g,onExitComplete:C?void 0:w,children:h},d)})})},j=k(),J=({flows:c})=>{var p;const[a,r]=n.useState({}),[i,m]=n.useState([]),[x,g]=n.useState(""),o=e=>{r(s=>({...s,[e]:!s[e]}))},u=n.useMemo(()=>[j.accessor("id",{header:"ID",size:20}),j.accessor("title",{header:"診断タイトル"}),j.accessor("total",{header:"合計",size:25,cell:e=>t.jsx("div",{className:"text-start",children:e.getValue()})}),j.display({id:"viewGraph",header:"内訳",size:25,cell:({row:e})=>t.jsx("button",{onClick:()=>{o(e.index)},className:`select-none transtion-all duration-200
              ${a[e.index]?"text-red-400 hover:text-red-700":"text-indigo-400 hover:text-indigo-700"}`,children:a[e.index]?"閉じる":"表示"})})],[a]),l=I({data:c,columns:u,getCoreRowModel:D(),onSortingChange:m,getSortedRowModel:F(),getFilteredRowModel:T(),getPaginationRowModel:L(),state:{sorting:i,globalFilter:x},defaultColumn:{size:200}});return t.jsx(t.Fragment,{children:t.jsx("div",{className:"max-w-full w-11/12 mx-auto sm:px-6 lg:py-8",children:t.jsx("div",{className:"bg-white overflow-hidden shadow-sm",children:t.jsxs("div",{className:"pb-3 px-6",children:[t.jsxs("div",{className:"flex justify-start items-center h-24",children:[t.jsx("div",{className:"h-12 bg-slate-600 px-2 rounded-l",children:t.jsx(H,{className:"h-full block text-white"})}),t.jsx("div",{className:"h-full flex justify-center items-center",children:t.jsx($,{value:x??"",handleChange:e=>g(String(e)),className:"w-96 h-12 bg-transparent outline-none border rounded-r border-slate-300 focus:ring-0 focus:border-blue-500 placeholder:text-slate-400",placeholder:"検索"})})]}),t.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-700",children:[t.jsx("thead",{className:"text-sm text-gray-700 uppercase bg-gray-200 ",children:l.getHeaderGroups().map(e=>t.jsx("tr",{children:e.headers.map(s=>t.jsx("th",{colSpan:s.colSpan,style:{maxWidth:s.getSize()},children:s.isPlaceholder?null:t.jsxs("div",{className:`px-3 py-3 ${s.column.getCanSort()?"cursor-pointer select-none":""}`,onClick:s.column.getToggleSortingHandler(),title:s.column.getCanSort()?s.column.getNextSortingOrder()==="asc"?"昇順ソート":s.column.getNextSortingOrder()==="desc"?"降順ソート":"元の並びに戻す":void 0,children:[S(s.column.columnDef.header,s.getContext()),{asc:"↑",desc:"↓"}[s.column.getIsSorted()]??null]})},s.id))},e.id))}),t.jsx("tbody",{children:(p=l.getRowModel().rows)!=null&&p.length?l.getRowModel().rows.map(e=>t.jsxs(n.Fragment,{children:[t.jsx("tr",{"data-state":e.getIsSelected()&&"selected",className:"bg-white border-b ",children:e.getVisibleCells().map(s=>t.jsx("td",{className:"px-2 py-2",style:{maxWidth:`${s.column.getSize()}px`,overflow:"hidden",overflowWrap:"break-word"},children:S(s.column.columnDef.cell,s.getContext())},s.id))},e.id),t.jsx(q,{children:a[e.index]&&t.jsx(O,{flowId:e.original.id,colLength:u.length},`graph_${e.id}`)})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:u.length,className:"h-24 text-center",children:"対象レコード0件"})})})]}),t.jsxs("div",{className:"flex items-center justify-center mt-4 gap-8",children:[t.jsxs("div",{className:"w-12 flex justify-center gap-2",children:[t.jsx("button",{onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),className:"p-1 border border-gray-300 px-2 disabled:opacity-30 select-none cursor-pointer",children:"<"}),t.jsx("button",{onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),className:"p-1 border border-gray-300 px-2 disabled:opacity-30 select-none cursor-pointer",children:">"})]}),t.jsx("div",{className:"flex items-center",children:t.jsx("div",{className:"text-gray-500",children:`${l.getState().pagination.pageIndex+1} / ${l.getPageCount()}`})}),t.jsx("select",{value:l.getState().pagination.pageSize,onChange:e=>l.setPageSize(Number(e.currentTarget.value)),className:"py-2 pr-8 bg-transparent cursor-pointer select-none border-1 border-slate-200 focus:ring-0 focus:border-blue-500 text-sm",children:[10,20,30,50].map(e=>t.jsx("option",{value:e,children:`${e} 行表示`},e))})]})]})})})})},oe=n.memo(J);export{oe as default};
