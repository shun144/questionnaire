import{r,q as M,j as e,y as U}from"./app-MNzaSWed.js";import{u as a}from"./store-4eFm_Nke.js";import{u as J}from"./index-BV5GjtqN.js";import{M as z}from"./index-CYwCsC2B.js";import{M as H}from"./react-tooltip.min-X15aLG_L.js";/* empty css                          */import{n as c}from"./index-CNJg2eKG.js";import"./react-9o_-8awh.js";import"./iconBase-C8iXxnql.js";const V=50,A=15,B=({id:d,initialTitle:b,initialUrl:j})=>{const{props:y}=M(),u=y.auth.user.english_name,[x,N]=r.useState(b),[m,v]=r.useState(j),[l,f]=r.useState({}),{getNodes:S,getEdges:C,getViewport:T}=J(),p=a(t=>t.firstNodeId),n=a(t=>t.setIsDirty),k=a(t=>t.isDirty),h=r.useRef(null),[g,w]=r.useState(!1),q=t=>{if(t.preventDefault(),!p){c.error("1問目の質問を作成してください",{duration:5e3});return}const o=S(),i=C(),R=o.filter(s=>s.type==="qNode"),$=o.filter(s=>s.type==="rNode"),{x:_,y:E,zoom:F}=T();U.post(`/flow/${d}`,{update_questions:JSON.stringify(R),update_results:JSON.stringify($),update_edges:JSON.stringify(i),first_question_id:p,title:x,url:m,x:_,y:E,zoom:F},{onSuccess:()=>{f({}),c.success("保存しました",{duration:4e3}),n(!1)},onError:s=>{f(s);for(const I of Object.values(s))c.error(I,{duration:5e3})}})},D=t=>{N(t.currentTarget.value),n(!0)},L=t=>{v(t.currentTarget.value),n(!0)},O=async t=>{var o;try{t.preventDefault(),await navigator.clipboard.writeText(`${window.location.origin}/${u}/${(o=h.current)==null?void 0:o.value}`),w(!0),setTimeout(()=>w(!1),2e3)}catch(i){console.error("コピーに失敗しました:",i)}};return e.jsx("div",{className:"h-14 w-full bg-white",children:e.jsx("div",{className:"h-full w-full flex items-center bg-slate-100",children:e.jsxs("form",{onSubmit:q,className:"w-full h-14 flex justify-around items-center",children:[e.jsxs("div",{className:"h-full w-2/12 flex justify-between items-center",children:[e.jsx("div",{className:"text-gray-500/70 font-bold text-lg pl-4",children:`ID:${d}`}),e.jsx("div",{className:"h-10 w-16 ",children:e.jsxs("button",{className:"relative w-full h-full bg-indigo-500 px-2 text-white rounded-md shadow-xl transition-all hover:bg-indigo-600 select-none hover:shadow-xl duration-200",children:["保 存",k&&e.jsxs("span",{className:"absolute flex h-3 w-3 -top-1 -right-1",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-rose-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-rose-500 opacity-85"})]})]})})]}),e.jsxs("div",{className:"flex justify-start items-center pl-20 gap-x-10 w-10/12",children:[e.jsxs("div",{className:" flex flex-col items-center w-[675px]",children:[e.jsx("div",{children:l.title&&e.jsx("div",{className:"text-sm text-red-500",children:l.title})}),e.jsxs("div",{className:"flex w-full flex-row items-center",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-800 h-10 leading-10  text-center",children:"タイトル："}),e.jsx("input",{type:"text",id:"title",placeholder:"タイトルを入力してください",className:"grow bg-white border border-slate-400 text-gray-900 text-sm focus:ring-transparent focus:border-blue-400 block  p-2.5 h-full placeholder-slate-400 rounded",onChange:D,value:x,required:!0,maxLength:V})]})]}),e.jsxs("div",{className:" flex flex-col items-center w-[580px]",children:[e.jsx("div",{children:l.url&&e.jsx("div",{className:"text-sm text-red-500",children:l.url})}),e.jsxs("div",{className:"flex w-full flex-row items-center",children:[e.jsx("label",{htmlFor:"url",className:"block text-sm font-medium text-gray-800 h-10 leading-10  text-center",children:"URL："}),e.jsxs("div",{className:"text-gray-400 border-slate-300 pr-1 text-sm",children:[window.location.origin,"/",u,"/"]}),e.jsx("input",{type:"text",id:"url",placeholder:"URLを入力してください",ref:h,className:`grow bg-white  text-gray-900 text-sm focus:ring-transparent  block  p-2.5 h-full placeholder-slate-400 rounded ${l.url?"border-rose-300 focus:border-rose-400 border-2":"border-slate-400 focus:border-blue-400 border"} `,onChange:L,value:m,required:!0,maxLength:A}),e.jsx("button",{"data-tooltip-id":"my-tooltip","data-tooltip-content":"URLをコピーしました",onClick:O,className:"pl-2 py-2 text-indigo-400 rounded transition-all hover:text-indigo-800 duration-300",children:e.jsx(z,{})}),g&&e.jsx(H,{id:"my-tooltip",place:"top",style:{background:"#6366f1",fontSize:"12px",padding:"4px 8px"},openOnClick:!0,isOpen:g})]})]})]})]})})})},te=r.memo(B);export{te as default};
