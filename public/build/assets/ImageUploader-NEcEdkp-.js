import{r,q as v,j as a}from"./app-MNzaSWed.js";import{u as f}from"./store-4eFm_Nke.js";import{u as U}from"./index-BV5GjtqN.js";import"./react-9o_-8awh.js";function $(e){return e instanceof File}const E=({imageData:e})=>{const[l,o]=r.useState(void 0);return r.useEffect(()=>{if($(e)){let s=new FileReader;return s.onloadend=()=>{const n=s&&s.result;n&&typeof n=="string"&&o(n)},s.readAsDataURL(e),()=>{s=null}}else o(e)},[e]),l},R=({nodeId:e,initImgUrl:l})=>{const{props:o}=v(),s=o.auth.user.id,{updateNodeData:n}=U(),p=r.useMemo(()=>"http://127.0.0.1:8000",[]),m=r.useMemo(()=>`img-${e}`,[]),h=f(t=>t.addImage),x=f(t=>t.delImage),[I,u]=r.useState(l),d=E({imageData:I}),g=t=>{n(e,{img:t})},w=t=>{const i=t.currentTarget;if(!i||!i.files)return;const c=i.files[0];u(c),h({nodeId:e,file:c});const F=c.name.split(".").pop(),b=`${p}/storage/user_${s}/images/${e}.${F}`;g(b)},j=t=>{confirm("画像を削除しますか？")&&(t.preventDefault(),u(void 0),x(e),g(""))};return a.jsx("label",{className:"w-full h-32 border border-dashed bg-slate-900  border-slate-300 rounded-md flex justify-center items-center overflow-hidden cursor-pointer",htmlFor:m,children:d?a.jsx("img",{className:"w-full h-full object-scale-down",src:d,alt:"アップロード画像",onClick:j}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-slate-500",children:"画像をアップロード"}),a.jsx("input",{id:m,type:"file",accept:"image/jpeg, image/png",onChange:w,hidden:!0})]})})},D=r.memo(R);export{D as default};
